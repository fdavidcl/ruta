<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Building neural architectures â€¢ ruta</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Building neural architectures">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ruta</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/examples/autoencoder_basic.html">
    <span class="fa fa-code"></span>
     
    Get started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/architectures.html">Building neural architectures</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Autoencoder variants</li>
    <li>
      <a href="../articles/examples/autoencoder_contractive.html">Contractive autoencoder</a>
    </li>
    <li>
      <a href="../articles/examples/autoencoder_denoising.html">Denoising autoencoder</a>
    </li>
    <li>
      <a href="../articles/examples/autoencoder_robust.html">Robust autoencoder</a>
    </li>
    <li>
      <a href="../articles/examples/autoencoder_sparse.html">Sparse autoencoder</a>
    </li>
    <li>
      <a href="../articles/examples/autoencoder_variational.html">Variational autoencoder</a>
    </li>
    <li>
      <a href="../articles/examples/autoencoder_convolutional.html">Convolutional autoencoder</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/troubleshooting.html">
    <span class="fa fa-wrench"></span>
     
    Troubleshooting
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/">
    <span class="fa fa-book"></span>
     
    Documentation
  </a>
</li>
<li>
  <a href="https://github.com/fdavidcl/ruta">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Building neural architectures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fdavidcl/ruta/blob/master/vignettes/architectures.Rmd"><code>vignettes/architectures.Rmd</code></a></small>
      <div class="hidden name"><code>architectures.Rmd</code></div>

    </div>

    
    
<p>Ruta allows creating the neural architecture of autoencoders in several ways. The easiest way is to use an integer vector describing the number of units of each hidden layer in the encoder:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(ruta)</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4">net &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1-5" title="5">net <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/as_network.html">as_network</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>()</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; Network structure:</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt;  input</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt;  dense(1000 units) - linear</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt;  dense(100 units) - linear</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt;  dense(1000 units) - linear</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;  dense - linear</span></a></code></pre></div>
<p>The input and output layers have an undetermined size until training data is used and the autoencoder is converted onto a Keras model.</p>
<p>By using <a href="/reference/#section-neural-network-architecture">separate functions</a> for each layer type, one may define the activations at the output of each layer:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">net &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/input.html">input</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/dense.html">dense</a></span>(<span class="dv">1000</span>, <span class="st">"relu"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/dense.html">dense</a></span>(<span class="dv">100</span>, <span class="st">"tanh"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="st">  </span><span class="kw"><a href="../reference/dense.html">dense</a></span>(<span class="dv">1000</span>, <span class="st">"relu"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="st">  </span><span class="kw"><a href="../reference/output.html">output</a></span>(<span class="st">"sigmoid"</span>)</a>
<a class="sourceLine" id="cb2-7" title="7"></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="kw">print</span>(net)</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; Network structure:</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;  input</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt;  dense(1000 units) - relu</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt;  dense(100 units) - tanh</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt;  dense(1000 units) - relu</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt;  dense - sigmoid</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="kw">plot</span>(net)</a></code></pre></div>
<p><img src="architectures_files/figure-html/structure-1.png" width="480"></p>
<p>Other available layers are <code>dropout</code> and other Keras layers via the <code>layer_keras</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">act_reg &lt;-<span class="st"> </span><span class="kw"><a href="../reference/layer_keras.html">layer_keras</a></span>(<span class="st">"activity_regularization"</span>, <span class="dt">l1 =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">net &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">  </span><span class="kw"><a href="../reference/input.html">input</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="st">  </span><span class="kw"><a href="../reference/dense.html">dense</a></span>(<span class="dv">1000</span>, <span class="st">"relu"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/dropout.html">dropout</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="st">  </span><span class="kw"><a href="../reference/dense.html">dense</a></span>(<span class="dv">100</span>, <span class="st">"tanh"</span>) <span class="op">+</span><span class="st"> </span>act_reg <span class="op">+</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="st">  </span><span class="kw"><a href="../reference/dense.html">dense</a></span>(<span class="dv">1000</span>, <span class="st">"relu"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/dropout.html">dropout</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/output.html">output</a></span>(<span class="st">"sigmoid"</span>)</a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="kw">print</span>(net)</a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; Network structure:</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;  input</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt;  dense(1000 units) - relu</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt;  dense(100 units) - tanh</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt;  dense(1000 units) - relu</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt;  dense - sigmoid</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="kw">plot</span>(net, <span class="dt">log =</span> <span class="ot">TRUE</span>, <span class="dt">fg =</span> <span class="st">"#30707a"</span>, <span class="dt">bg =</span> <span class="st">"#e0e6ea"</span>)</a></code></pre></div>
<p><img src="architectures_files/figure-html/custom-1.png" width="480"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://david.quotient.space">David Charte</a>, Francisco Charte, Francisco Herrera.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
